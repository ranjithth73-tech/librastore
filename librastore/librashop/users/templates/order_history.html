{% extends 'base.html' %}

{% block content %}

<style>
.order-history-container {
  padding-top: 120px; /* Space for fixed navbar */
  padding-bottom: 60px;
  min-height: 100vh;
}

.table {
  background-color: rgba(255, 255, 255, 0.1);
  border-collapse: separate;
  border-spacing: 0;
  border-radius: 15px;
  overflow: hidden;
  color: #fff;
}

.table thead {
  font-weight: bold;
  font-size: 1rem;
}

.table tbody tr {
  transition: background-color 0.3s ease;
}

.table tbody tr:hover {
  background-color: rgba(255, 255, 255, 0.05);
}

.badge {
  font-size: 0.85rem;
  padding: 0.5em 0.75em;
  border-radius: 1rem;
}

.order-history-heading {
  color: #ffd54f;
  text-shadow: 0 2px 10px rgba(255, 193, 7, 0.6);
  margin-bottom: 2rem;
}
</style>

<div class="container order-history-container">
  <h2 class="text-center mb-4 fw-bold order-history-heading">Your Order History</h2>

  {% if orders %}
  <div class="table-responsive shadow rounded-4 overflow-hidden">
    <table class="table align-middle mb-0">
      <thead class="table-warning text-dark">
        <tr>
          <th scope="col">Order ID</th>
          <th scope="col">Date</th>
          <th scope="col">Items</th>
          <th scope="col">Total</th>
          <th scope="col">Status</th>
          <th scope="col">Action</th>
        </tr>
      </thead>
      <tbody>
        {% for order in orders %}
        <tr class="order-row">
          <td class="fw-semibold">#{{ order.id }}</td>
          <td>{{ order.date_odered|date:"M d, Y" }}</td>
          <td>
            {% for item in order.orderitem_set.all %}
              {{ item.product.name }}{% if not forloop.last %}, {% endif %}
            {% empty %}
              <span class="text-muted">No items</span>
            {% endfor %}
          </td>
          <td>₹{{ order.get_cart_total|floatformat:2 }}</td>
          <td>
            {% if order.status == "Completed" %}
              <span class="badge bg-success">{{ order.status }}</span>
            {% elif order.status == "Pending" %}
              <span class="badge bg-warning text-dark">{{ order.status }}</span>
            {% elif order.status == "Cancelled" %}
              <span class="badge bg-danger">{{ order.status }}</span>
            {% else %}
              <span class="badge bg-secondary">{{ order.status }}</span>
            {% endif %}
          </td>
          <td>
            <span class="badge bg-info">Order #{{ order.id }}</span>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div class="text-center mt-5">
    <i class="bi bi-bag-x display-3 text-muted"></i>
    <h5 class="text-muted mt-3">You haven’t placed any orders yet.</h5>
    <a href="{% url 'home' %}" class="btn btn-warning text-dark fw-semibold rounded-pill mt-3 px-4">Start Shopping</a>
  </div>
  {% endif %}
</div>

{% endblock %}